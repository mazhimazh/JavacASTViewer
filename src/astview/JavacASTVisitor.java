package astview;

import com.sun.source.tree.*;
import com.sun.tools.javac.tree.JCTree;
import com.sun.tools.javac.tree.JCTree.*;
import com.sun.tools.javac.util.List;
import com.sun.tools.javac.util.ListBuffer;

public class JavacASTVisitor implements TreeVisitor<JavacASTNode,Void> {

	@Override
	public JavacASTNode visitAnnotatedType(AnnotatedTypeTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitAnnotation(AnnotationTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitArrayAccess(ArrayAccessTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitArrayType(ArrayTypeTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitAssert(AssertTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitAssignment(AssignmentTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitBinary(BinaryTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitBlock(BlockTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitBreak(BreakTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitCase(CaseTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitCatch(CatchTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitCompoundAssignment(CompoundAssignmentTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitConditionalExpression(ConditionalExpressionTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitContinue(ContinueTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitDoWhileLoop(DoWhileLoopTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitEmptyStatement(EmptyStatementTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitEnhancedForLoop(EnhancedForLoopTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitErroneous(ErroneousTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitExpressionStatement(ExpressionStatementTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitForLoop(ForLoopTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}


	@Override
	public JavacASTNode visitIf(IfTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}


	@Override
	public JavacASTNode visitInstanceOf(InstanceOfTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitIntersectionType(IntersectionTypeTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitLabeledStatement(LabeledStatementTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitLambdaExpression(LambdaExpressionTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitLiteral(LiteralTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitMemberReference(MemberReferenceTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitMemberSelect(MemberSelectTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitMethod(MethodTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitMethodInvocation(MethodInvocationTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitModifiers(ModifiersTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitNewArray(NewArrayTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitNewClass(NewClassTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitOther(Tree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitParameterizedType(ParameterizedTypeTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitParenthesized(ParenthesizedTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitPrimitiveType(PrimitiveTypeTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitReturn(ReturnTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitSwitch(SwitchTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitSynchronized(SynchronizedTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitThrow(ThrowTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitTry(TryTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitTypeCast(TypeCastTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitTypeParameter(TypeParameterTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitUnary(UnaryTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitUnionType(UnionTypeTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitVariable(VariableTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitWhileLoop(WhileLoopTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public JavacASTNode visitWildcard(WildcardTree arg0, Void arg1) {
		// TODO Auto-generated method stub
		return null;
	}
	
	//  public abstract <R,D> R accept(TreeVisitor<R,D> v, D d);
	
	
	public JavacASTNode traverse(JCTree tree) {
		if (tree == null)
			return null;
		return tree.accept(this,null);
	}

	public  <T extends JCTree> List<JavacASTNode> traverse(List<T> trees) {
		if (trees == null)
			return null;
		ListBuffer<JavacASTNode> lb = new ListBuffer<JavacASTNode>();
		for (JCTree tree : trees) {
			JavacASTNode node = traverse(tree);
			if(node!=null)
			   lb.append(node);
		}
		return lb.toList();
	}
    
    
	@Override
	public JavacASTNode visitCompilationUnit(CompilationUnitTree node, Void p) {
		JCCompilationUnit t = (JCCompilationUnit) node;
		JavacASTNode currnode = new JavacASTNode(node.getKind());
		currnode.setName("root");
		currnode.setType("{JCCompilationUnit}");

		JavacASTNode pid = traverse(t.pid);
		if(pid!=null) {
			pid.setName("pid");
			pid.setType(pid.getKind().name());
			pid.setParent(currnode);
			currnode.addChild(pid);
		}
		

		JavacASTNode defs = new JavacASTNode("defs", "{List<JCTree>}")   ;
		defs.setParent(currnode);
		currnode.addChild(defs);
		List<JavacASTNode> def = traverse(t.defs);
		for (int i = 0; i < def.size(); i++) {
			JavacASTNode sub = def.get(i);
			sub.setName(i + "");
			sub.setType(sub.getKind().name());
			defs.addChild(sub);
			sub.setParent(defs);
		}

		return currnode;
	}
    
	@Override
	public JavacASTNode visitClass(ClassTree node, Void p) {
		JCClassDecl t = (JCClassDecl) node;
		JavacASTNode currnode = new JavacASTNode(node.getKind());
		
		
		JavacASTNode ext = traverse(t.extending);
		if(ext!=null) {
			ext.setName("extending");
			ext.setType(ext.getKind().name());
			ext.setParent(currnode);
			currnode.addChild(ext);
		}
		

		if (t.implementing != null && t.implementing.size() > 0) {
			JavacASTNode impls = new JavacASTNode("implementing", "{List<JCExpression>}") ;
			impls.setParent(currnode);
			currnode.addChild(impls);
			List<JavacASTNode> impl = traverse(t.implementing);
			for (int i = 0; i < impl.size(); i++) {
				JavacASTNode sub = impl.get(i);
				sub.setName(i + "");
				sub.setType(sub.getKind().name());
				impls.addChild(sub);
				sub.setParent(impls);
			}
		}
		
		if (t.defs != null && t.defs.size() > 0) {
			JavacASTNode defs = new JavacASTNode("defs", "{List<JCTree>}") ;
			defs.setParent(currnode);
			currnode.addChild(defs);
			List<JavacASTNode> def = traverse(t.defs);
			for (int i = 0; i < def.size(); i++) {
				JavacASTNode sub = def.get(i);
				sub.setName(i + "");
				sub.setType(sub.getKind().name());
				defs.addChild(sub);
				sub.setParent(defs);
			}
		}

		return currnode;
	}
	
	public JavacASTNode visitImport(ImportTree node, Void curr) {
		JCImport t = (JCImport) node;
		JavacASTNode currnode = new JavacASTNode(node.getKind());
		
		JavacASTNode qualid = traverse(t.qualid);
		qualid.setName("qualid");
		qualid.setType(qualid.getKind().name());
		
		qualid.setParent(currnode);
		currnode.addChild(qualid);
		
		return currnode;
	}
	
	@Override
	public JavacASTNode visitIdentifier(IdentifierTree node, Void p) {
		JCIdent t = (JCIdent) node;
		JavacASTNode currnode = new JavacASTNode(node.getKind());
		JavacASTNode qualid = new JavacASTNode("name", "{SharedNameTable$NameImpl}",t.name.toString());
		currnode.addChild(qualid);
		qualid.setParent(currnode);
		return currnode;
	}

}




